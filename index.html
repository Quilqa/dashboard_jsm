<!doctype html>
<html lang="ru" data-theme="dark">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>–î–∞—à–±–æ—Ä–¥ JSM</title>
<style>
    /* Password gate */
    .gate{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;
          background:color-mix(in oklab, var(--bg) 75%, black);z-index:9999}
    .gate-card{background:var(--card);border:1px solid var(--border);border-radius:14px;
               padding:16px;box-shadow:var(--shadow);min-width:min(92vw,420px)}
    .gate-card h2{margin:0 0 8px}
    .gate-row{display:flex;gap:8px;margin-top:8px}
    .gate-row input{flex:1;padding:10px;border-radius:10px;border:1px solid var(--border);
                    background:var(--chip);color:var(--text)}
    .gate-err{color:var(--danger);min-height:1.2em;margin-top:8px}
    .wrap.locked{display:none}

  :root{
    --bg:#0b1020; --card:#101935; --muted:#8aa0c6; --text:#eaf1ff;
    --accent:#2f7dff; --accent-2:#72cd6a; --border:#1f2a4a;
    --chip:#2a3b73; --chip-on:#1f3e72; --chip-off:#0f1f41; --danger:#ff6a6a; --shadow:0 6px 20px rgba(0,0,0,.25);
    --table-head:#0e1a36; --table-foot:#0e1a36; --toggle-bg:#0f1f41;
  }
  :root[data-theme="light"]{
    --bg:#f6f8ff; --card:#ffffff; --muted:#5a6a8a; --text:#0b1020;
    --accent:#1e60ff; --accent-2:#1a9a44; --border:#dce3f5;
    --chip:#dbe6ff; --chip-on:#bcd3ff; --chip-off:#eef4ff; --danger:#d22; --shadow:0 6px 20px rgba(0,0,0,.08);
    --table-head:#f0f4ff; --table-foot:#f0f4ff; --toggle-bg:#e9f0ff;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--text);font:14px/1.5 system-ui,Segoe UI,Roboto,Arial,sans-serif; overflow-x:hidden}
  header{padding:14px 18px;border-bottom:1px solid var(--border);position:sticky;top:0;background:linear-gradient(0deg,var(--bg),color-mix(in oklab, var(--bg) 80%, transparent));backdrop-filter:saturate(1.2) blur(6px);display:flex;gap:10px;align-items:center;z-index:5}
  h1{margin:0;font-size:18px}
  .muted{color:var(--muted)} .small{font-size:12px}
  .spacer{flex:1}
  .tbtn{padding:8px 10px;border:1px solid var(--border);border-radius:10px;background:var(--chip);cursor:pointer}
  .wrap{padding:16px 18px;display:grid;gap:14px}
  .grid{display:grid;gap:12px}
  @media (min-width: 1100px){ .grid{grid-template-columns: 360px 1fr} }
  .panel{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:12px;box-shadow:var(--shadow)}
  .panel h2{margin:0 0 8px;font-size:13px;color:var(--muted);text-transform:uppercase;letter-spacing:.06em}
  input[type="range"]{width:100%; height:28px; touch-action:none}
  button{background:var(--chip);color:var(--text);border:1px solid var(--border);padding:8px 10px;border-radius:10px;outline:none;cursor:pointer}
  .btn{background:color-mix(in oklab, var(--accent) 15%, var(--chip)); border-color: color-mix(in oklab, var(--accent) 25%, var(--border))}
  .btn.ghost{background:transparent}
  .toolbar{display:flex;gap:8px;align-items:center;justify-content:space-between;flex-wrap:wrap}
  .badge{display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border:1px solid var(--border);border-radius:8px;background:var(--chip);color:var(--text)}

  /* chips: –∞–∫—Ç–∏–≤–Ω—ã–µ —Ç–µ–º–Ω–µ–µ, –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –±–ª–µ–¥–Ω–µ–µ */
  .chips{display:flex;gap:6px;flex-wrap:wrap}
  .chip{padding:6px 9px;border:1px solid var(--border);border-radius:999px;user-select:none;cursor:pointer;background:var(--chip-off);opacity:.6}
  .chip.active{background:var(--chip-on);opacity:1}

  /* –∫–Ω–æ–ø–∫–∏-–∞–∫–∫–æ—Ä–¥–µ–æ–Ω—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ */
  .filter-toggle{display:flex;align-items:center;gap:8px; width:100%}
  .filter-toggle .caret{transition:transform .15s ease}
  .filter-toggle[aria-expanded="true"] .caret{transform:rotate(90deg)}
  .hidden{display:none}

  .rowcell{display:flex;align-items:center;gap:8px}
  .indent{display:inline-block;width:14px}
  .toggle{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border:1px solid var(--border);border-radius:4px;background:var(--toggle-bg);cursor:pointer}
  .toggle.blank{visibility:hidden}

  .table-wrap{overflow:auto;max-height:70vh;border:1px solid var(--border);border-radius:14px; -webkit-overflow-scrolling:touch}
  table{border-collapse:separate;border-spacing:0;width:100%;min-width:1100px;background:var(--card)}
  thead th{position:sticky;top:0;background:var(--table-head);border-bottom:1px solid var(--border);padding:10px 8px;text-align:left;font-weight:600;white-space:nowrap;z-index:2}
  thead tr:nth-child(2) th{ position:static; }
  thead th.metric{ text-align:right }

  tbody td{border-bottom:1px solid var(--border);padding:7px 8px;white-space:nowrap}
  tfoot td{position:sticky;bottom:0;background:var(--table-foot);border-top:1px solid var(--border);padding:10px 8px;font-weight:700}
  .num{text-align:right;font-variant-numeric:tabular-nums}
  .green{color:var(--accent-2);font-weight:600}
  .red{color:var(--danger);font-weight:600}

  /* ===== –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è ===== */
  @media (max-width: 900px){
    .grid{grid-template-columns: 1fr}
    body{font-size:15px}
    h1{font-size:18px}
    .panel{padding:14px}
    .table-wrap{max-height:65vh}
    table{min-width:640px}
    thead th.metric{text-align:right}
    thead th{padding:10px 10px}
    tbody td, tfoot td{padding:9px 10px}
    .chip{padding:8px 10px;font-size:15px}
    button{padding:10px 12px}
    .toggle{width:22px;height:22px}
    .indent{width:16px}
  }
  @media (max-width: 480px){
    body{font-size:16px}
    h1{font-size:19px}
    .panel{padding:12px}
    table{min-width:560px}
    thead th{font-size:13px}
    tbody td, tfoot td{font-size:13px}
    .chip{padding:10px 12px;font-size:16px}
    button{padding:12px 14px;font-size:15px}
    thead th{position:static !important}
    .wrap{padding:12px 10px}
  }
</style>
</head>
<body>
<header>
  <h1>–î–∞—à–±–æ—Ä–¥ JSM</h1>
  <div class="spacer"></div>
  <button id="themeToggle" class="tbtn" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">üåô –¢–µ–º–∞</button>
</header>

<div id="gate" class="gate">
  <div class="gate-card">
    <h2>–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å</h2>
    <div class="gate-row">
      <input id="gatePass" type="password" placeholder="–ü–∞—Ä–æ–ª—å" autocomplete="current-password">
      <button id="gateBtn" class="btn">–û—Ç–∫—Ä—ã—Ç—å</button>
    </div>
    <div id="gateErr" class="gate-err"></div>
  </div>
</div>

<div class="wrap locked">
  <!-- –°–õ–ê–ô–î–ï–† –ü–ï–†–ò–û–î–ê ‚Äî –°–ê–ú–´–ô –í–ï–†–•, –ù–ê –í–°–Æ –®–ò–†–ò–ù–£ -->
  <div class="panel">
    <h2>–ü–µ—Ä–∏–æ–¥</h2>
    <div class="badge" style="margin-bottom:8px">–î–∞—Ç–∞: <span id="dateLabel">‚Äî</span></div>
    <input id="dateSlider" type="range" min="0" max="0" value="0" step="1" disabled>
  </div>

  <div class="grid">
    <!-- –õ–ï–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –§–ò–õ–¨–¢–†–´ -->
    <div class="panel">
      <h2>–§–∏–ª—å—Ç—Ä—ã</h2>

      <button id="toggleSeg" class="btn filter-toggle" aria-expanded="false">
        <span class="caret">‚ñ∂</span><span>–°–µ–≥–º–µ–Ω—Ç</span>
      </button>
      <div id="segChips" class="chips hidden" style="margin:8px 0 12px"></div>

      <button id="toggleFil" class="btn filter-toggle" aria-expanded="false">
        <span class="caret">‚ñ∂</span><span>–§–∏–ª–∏–∞–ª</span>
      </button>
      <div id="filChips" class="chips hidden" style="margin:8px 0 12px"></div>

      <div class="toolbar" style="margin-top:8px">
        <div style="display:flex;gap:8px">
          <button id="collapseAll" class="btn ghost" disabled>–°–≤–µ—Ä–Ω—É—Ç—å –≤—Å—ë</button>
          <button id="expandAll" class="btn ghost" disabled>–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤—Å—ë</button>
        </div>
        <button id="downloadCsvRaw" class="btn">–≠–∫—Å–ø–æ—Ä—Ç CSV</button>
      </div>
      <div class="muted small" id="status" style="margin-top:8px">–ò–¥—ë—Ç —Ä–∞–∑–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö‚Ä¶</div>
    </div>

    <!-- –ü–†–ê–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –¢–ê–ë–õ–ò–¶–ê -->
    <div class="panel">
      <h2>–ë—é–¥–∂–µ—Ç</h2>
      <div class="table-wrap" style="margin-top:8px">
        <table id="pivot">
          <thead id="thead"></thead>
          <tbody id="tbody"></tbody>
          <tfoot id="tfoot"></tfoot>
        </table>
      </div>
    </div>
  </div>
</div>

<script>
/* ===== –ü–∞—Ä–æ–ª—å (–ª–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ SHA-256) ===== */
const PASS_HASH = "9d9653d7748c69904c6ef94a72479d50199cb344499e073448199b40642538ea"; // –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –∏–∑ –Ω–æ—É—Ç–±—É–∫–∞

async function sha256Hex(str){
  const enc = new TextEncoder().encode(str);
  const buf = await crypto.subtle.digest('SHA-256', enc);
  return [...new Uint8Array(buf)].map(b=>b.toString(16).padStart(2,'0')).join('');
}
async function tryUnlock(){
  const inp = document.getElementById('gatePass');
  const err = document.getElementById('gateErr');
  const typedHash = await sha256Hex(inp.value);
  if (typedHash === PASS_HASH){
    document.getElementById('gate').remove();
    document.querySelector('.wrap').classList.remove('locked');
  } else {
    err.textContent = '–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å';
    inp.select();
  }
}
document.getElementById('gateBtn').onclick = tryUnlock;
document.getElementById('gatePass').addEventListener('keydown', e=>{
  if(e.key==='Enter'){ e.preventDefault(); tryUnlock(); }
});

/* ===== –¢–µ–º–∞ ===== */
(function initTheme(){
  const saved = localStorage.getItem('theme');
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
  const initial = saved || (prefersDark ? 'dark' : 'light');
  document.documentElement.setAttribute('data-theme', initial);
  const btn = document.getElementById('themeToggle');
  const setIcon = () => btn.textContent = (document.documentElement.getAttribute('data-theme')==='dark'?'üåô –¢–µ–º–∞':'‚òÄÔ∏è –¢–µ–º–∞');
  setIcon();
  btn.onclick = () => {
    const cur = document.documentElement.getAttribute('data-theme');
    const next = (cur==='dark') ? 'light' : 'dark';
    document.documentElement.setAttribute('data-theme', next);
    localStorage.setItem('theme', next);
    setIcon();
  };
})();

/* ===== –î–ê–ù–ù–´–ï (CSV –∏–∑ pandas) ===== */
const CSV_TEXT = `Date;Conssegm;Fil;plan;fact;plan_full;fact_full
01.01.2025;B2B;–ê–°;122257784.0;110089593.0;122257784.0;110089593.0
01.01.2025;B2B;–ê–§;52065648.0;58764534.0;52065648.0;58764534.0
01.01.2025;B2B;–ë–£–ü;0.0;41499004.0;;41499004.0
01.01.2025;B2B;–í–§;16174989.0;18219230.0;16174989.0;18219230.0
01.01.2025;B2B;–ì–û;22172673.0;19223553.0;22172673.0;19223553.0
01.01.2025;B2B;–ó–§;166826409.0;156756308.0;166826409.0;156756308.0
01.01.2025;B2B;–ö–§;14124266.0;13277810.0;14124266.0;13277810.0
01.01.2025;B2B;–ú–§;76622420.0;61278804.0;76622420.0;61278804.0
01.01.2025;B2B;–°–¢–°;35661192.0;65200740.0;35661192.0;65200740.0
01.01.2025;B2B;–£–§;38202274.0;34025544.0;38202274.0;34025544.0
01.01.2025;B2B;–®–§;33483817.0;35890376.0;33483817.0;35890376.0
01.01.2025;B2B;–Æ–§;83415551.0;86598468.0;83415551.0;86598468.0
01.01.2025;B2C;–ê–°;1035453.0;769375.0;1035453.0;769375.0
01.01.2025;B2C;–ê–§;349397.0;232771.0;349397.0;232771.0
01.01.2025;B2C;–í–§;68805.0;66851.0;68805.0;66851.0
01.01.2025;B2C;–ó–§;670405.0;1041793.0;670405.0;1041793.0
01.01.2025;B2C;–ú–§;620709.0;469195.0;620709.0;469195.0
01.01.2025;B2C;–°–¢–°;483786.0;228010.0;483786.0;228010.0
01.01.2025;B2C;–£–§;187519.0;109756.0;187519.0;109756.0
01.01.2025;B2C;–Æ–§;15723.0;8170.0;15723.0;8170.0
01.01.2025;B2G;–ê–°;45281698.0;23454718.0;45281698.0;23454718.0
01.01.2025;B2G;–ê–§;4006527.0;867978.0;4006527.0;867978.0
01.01.2025;B2G;–ë–£–ü;0.0;0.0;;
01.01.2025;B2G;–í–§;12284794.0;4657730.0;12284794.0;4657730.0
01.01.2025;B2G;–ì–û;487373.0;0.0;487373.0;
01.01.2025;B2G;–ó–§;8877012.0;4200237.0;8877012.0;4200237.0
01.01.2025;B2G;–ö–§;10779121.0;9134277.0;10779121.0;9134277.0
01.01.2025;B2G;–ú–§;12357108.0;10058059.0;12357108.0;10058059.0
01.01.2025;B2G;–°–¢–°;216521.0;438559.0;216521.0;438559.0
01.01.2025;B2G;–£–§;3900286.0;1882756.0;3900286.0;1882756.0
01.01.2025;B2G;–®–§;7994169.0;4085141.0;7994169.0;4085141.0
01.01.2025;B2G;–Æ–§;13413100.0;30388895.0;13413100.0;30388895.0
01.01.2025;B2O;–ê–°;1231522.0;371989.0;1231522.0;371989.0
01.01.2025;B2O;–ê–§;4398587.0;4792727.0;4398587.0;4792727.0
01.01.2025;B2O;–í–§;1767825.0;1166625.0;1767825.0;1166625.0
01.01.2025;B2O;–ì–û;631894812.0;644052466.0;631894812.0;644052466.0
01.01.2025;B2O;–ó–§;7977758.0;8051292.0;7977758.0;8051292.0
01.01.2025;B2O;–ö–§;264669.0;115602.0;264669.0;115602.0
01.01.2025;B2O;–ú–§;30231798.0;30000434.0;30231798.0;30000434.0
01.01.2025;B2O;–°–¢–°;556523.0;459989.0;556523.0;459989.0
01.01.2025;B2O;–£–§;3725977.0;5723698.0;3725977.0;5723698.0
01.01.2025;B2O;–®–§;15813703.0;20362302.0;15813703.0;20362302.0
01.01.2025;B2O;–Æ–§;4921746.0;3960749.0;4921746.0;3960749.0
01.02.2025;B2B;–ê–°;125393478.0;117179521.0;247651262.0;227269114.0
01.02.2025;B2B;–ê–§;52909907.0;59959747.0;104975556.0;118724281.0
01.02.2025;B2B;–ë–£–ü;0.0;0.0;;41499004.0
01.02.2025;B2B;–í–§;18274470.0;17300387.0;34449459.0;35519617.0
01.02.2025;B2B;–ì–û;22172673.0;26289670.0;44345345.0;45513223.0
01.02.2025;B2B;–ó–§;167157912.0;158547100.0;333984321.0;315303408.0
01.02.2025;B2B;–ö–§;14501895.0;12867459.0;28626161.0;26145269.0
01.02.2025;B2B;–ú–§;77236669.0;71006759.0;153859089.0;132285563.0
01.02.2025;B2B;–°–¢–°;36424841.0;61282116.0;72086034.0;126482856.0
01.02.2025;B2B;–£–§;38365109.0;35049893.0;76567384.0;69075436.0
01.02.2025;B2B;–®–§;33515475.0;33944548.0;66999292.0;69834924.0
01.02.2025;B2B;–Æ–§;85381555.0;85373407.0;168797106.0;171971875.0
01.02.2025;B2C;–ê–°;968343.0;794333.0;2003796.0;1563708.0
01.02.2025;B2C;–ê–§;353899.0;230870.0;703296.0;463641.0
01.02.2025;B2C;–í–§;66531.0;62114.0;135336.0;128965.0
01.02.2025;B2C;–ó–§;681876.0;1009021.0;1352282.0;2050814.0
01.02.2025;B2C;–ú–§;610280.0;458404.0;1230989.0;927600.0
01.02.2025;B2C;–°–¢–°;479122.0;210010.0;962908.0;438020.0
01.02.2025;B2C;–£–§;184363.0;109392.0;371883.0;219149.0
01.02.2025;B2C;–Æ–§;15592.0;8170.0;31314.0;16339.0
01.02.2025;B2G;–ê–°;50642085.0;27048284.0;95923783.0;50503002.0
01.02.2025;B2G;–ê–§;3880955.0;2236785.0;7887482.0;3104762.0
01.02.2025;B2G;–ë–£–ü;0.0;0.0;;
01.02.2025;B2G;–í–§;13420334.0;1515144.0;25705127.0;6172875.0
01.02.2025;B2G;–ì–û;2339392.0;0.0;2826766.0;
01.02.2025;B2G;–ó–§;9788394.0;6669787.0;18665406.0;10870024.0
01.02.2025;B2G;–ö–§;11103496.0;16752369.0;21882617.0;25886646.0
01.02.2025;B2G;–ú–§;12677731.0;16286693.0;25034839.0;26344752.0
01.02.2025;B2G;–°–¢–°;344832.0;538043.0;561353.0;976602.0
01.02.2025;B2G;–£–§;4100278.0;1558405.0;8000564.0;3441161.0
01.02.2025;B2G;–®–§;8025320.0;2334540.0;16019488.0;6419681.0
01.02.2025;B2G;–Æ–§;12489660.0;33304206.0;25902761.0;63693101.0
01.02.2025;B2O;–ê–°;1323083.0;593464.0;2554606.0;965453.0
01.02.2025;B2O;–ê–§;4478320.0;5379538.0;8876908.0;10172265.0
01.02.2025;B2O;–í–§;1799870.0;1167747.0;3567694.0;2334372.0
01.02.2025;B2O;–ì–û;619965895.0;628278029.0;1251860706.0;1272330495.0
01.02.2025;B2O;–ó–§;8046693.0;8562897.0;16024450.0;16614189.0
01.02.2025;B2O;–ö–§;269466.0;297451.0;534135.0;413053.0
01.02.2025;B2O;–ú–§;30687739.0;30395890.0;60919537.0;60396323.0
01.02.2025;B2O;–°–¢–°;586219.0;392427.0;1142742.0;852416.0
01.02.2025;B2O;–£–§;3724739.0;5908646.0;7450716.0;11632344.0
01.02.2025;B2O;–®–§;16110467.0;22779729.0;31924170.0;43142031.0
01.02.2025;B2O;–Æ–§;4993582.0;4837816.0;9915327.0;8798564.0
01.03.2025;B2B;–ê–°;128838736.0;118295802.0;376489998.0;345564916.0
01.03.2025;B2B;–ê–§;53739827.0;59613171.0;158715383.0;178337452.0
01.03.2025;B2B;–ë–£–ü;0.0;0.0;;41499004.0
01.03.2025;B2B;–í–§;19250026.0;17093420.0;53699485.0;52613037.0
01.03.2025;B2B;–ì–û;22172673.0;26211130.0;66518018.0;71724353.0
01.03.2025;B2B;–ó–§;167506997.0;164055955.0;501491318.0;479359363.0
01.03.2025;B2B;–ö–§;14794170.0;12287221.0;43420331.0;38432490.0
01.03.2025;B2B;–ú–§;77823366.0;72860489.0;231682455.0;205146053.0
01.03.2025;B2B;–°–¢–°;37227915.0;59907006.0;109313948.0;186389862.0
01.03.2025;B2B;–£–§;38445524.0;34119686.0;115012908.0;103195122.0
01.03.2025;B2B;–®–§;35400787.0;33238922.0;102400079.0;103073846.0
01.03.2025;B2B;–Æ–§;87560190.0;84233167.0;256357296.0;256205042.0
01.03.2025;B2C;–ê–°;908196.0;728478.0;2911993.0;2292186.0
01.03.2025;B2C;–ê–§;358408.0;225049.0;1061704.0;688690.0
01.03.2025;B2C;–í–§;75009.0;68133.0;210344.0;197098.0
01.03.2025;B2C;–ó–§;705127.0;1050105.0;2057408.0;3100920.0
01.03.2025;B2C;–ú–§;602258.0;454126.0;1833246.0;1381725.0
01.03.2025;B2C;–°–¢–°;474504.0;210010.0;1437413.0;648030.0
01.03.2025;B2C;–£–§;181261.0;109428.0;553144.0;328577.0
01.03.2025;B2C;–Æ–§;15462.0;8170.0;46776.0;24509.0
01.03.2025;B2G;–ê–°;58088638.0;35075713.0;154012421.0;85578714.0
01.03.2025;B2G;–ê–§;3880381.0;2382609.0;11767863.0;5487371.0
01.03.2025;B2G;–ë–£–ü;107142857.0;0.0;107142857.0;
01.03.2025;B2G;–í–§;13998913.0;6033810.0;39704040.0;12206685.0
01.03.2025;B2G;–ì–û;6579541.0;0.0;9406307.0;
01.03.2025;B2G;–ó–§;10749348.0;4244166.0;29414754.0;15114190.0
01.03.2025;B2G;–ö–§;12753925.0;10376812.0;34636542.0;36263458.0
01.03.2025;B2G;–ú–§;14156861.0;14093392.0;39191700.0;40438144.0
01.03.2025;B2G;–°–¢–°;604833.0;475064.0;1166186.0;1451666.0
01.03.2025;B2G;–£–§;4200557.0;1837389.0;12201120.0;5278550.0
01.03.2025;B2G;–®–§;8066966.0;6268631.0;24086454.0;12688312.0
01.03.2025;B2G;–Æ–§;13742067.0;5710173.0;39644828.0;69403273.0
01.03.2025;B2O;–ê–°;1414644.0;4973201.0;3969250.0;5938653.0
01.03.2025;B2O;–ê–§;4558053.0;8499194.0;13434960.0;18671458.0
01.03.2025;B2O;–í–§;1831915.0;1201347.0;5399609.0;3535719.0
01.03.2025;B2O;–ì–û;619537793.0;650520133.0;1871398499.0;1922850627.0
01.03.2025;B2O;–ó–§;8115628.0;8563013.0;24140078.0;25177202.0
01.03.2025;B2O;–ö–§;274264.0;217451.0;808399.0;630504.0
01.03.2025;B2O;–ú–§;31143681.0;31609162.0;92063218.0;92005485.0
01.03.2025;B2O;–°–¢–°;615914.0;343855.0;1758656.0;1196271.0
01.03.2025;B2O;–£–§;3723500.0;6894759.0;11174217.0;18527103.0
01.03.2025;B2O;–®–§;16407230.0;21645500.0;48331400.0;64787531.0
01.03.2025;B2O;–Æ–§;5065418.0;5434901.0;14980745.0;14233465.0
01.04.2025;B2B;–ê–°;132236186.0;123438985.0;508726184.0;469003901.0
01.04.2025;B2B;–ê–§;54712278.0;53758414.0;213427661.0;232095866.0
01.04.2025;B2B;–ë–£–ü;792128138.0;0.0;792128138.0;41499004.0
01.04.2025;B2B;–í–§;19527423.0;17014403.0;73226908.0;69627440.0
01.04.2025;B2B;–ì–û;22172673.0;26900687.0;88690690.0;98625041.0
01.04.2025;B2B;–ó–§;171594808.0;164744022.0;673086126.0;644103385.0
01.04.2025;B2B;–ö–§;15142718.0;12278168.0;58563049.0;50710658.0
01.04.2025;B2B;–ú–§;78507090.0;75510089.0;310189545.0;280656142.0
01.04.2025;B2B;–°–¢–°;38070918.0;60858907.0;147384866.0;247248769.0
01.04.2025;B2B;–£–§;38610592.0;34561628.0;153623500.0;137756750.0
01.04.2025;B2B;–®–§;36822179.0;34005811.0;139222258.0;137079657.0
01.04.2025;B2B;–Æ–§;89614883.0;88796938.0;345972179.0;345001980.0
01.04.2025;B2C;–ê–°;852040.0;706329.0;3764032.0;2998516.0
01.04.2025;B2C;–ê–§;362925.0;233643.0;1424629.0;922333.0
01.04.2025;B2C;–í–§;80005.0;63450.0;290349.0;260548.0
01.04.2025;B2C;–ó–§;724017.0;1016209.0;2781426.0;4117128.0
01.04.2025;B2C;–ú–§;594821.0;454216.0;2428067.0;1835941.0
01.04.2025;B2C;–°–¢–°;469933.0;206379.0;1907346.0;854409.0
01.04.2025;B2C;–£–§;178212.0;106726.0;731356.0;435302.0
01.04.2025;B2C;–Æ–§;15333.0;8170.0;62109.0;32679.0
01.04.2025;B2G;–ê–°;65319114.0;33864774.0;219331535.0;119443489.0
01.04.2025;B2G;–ê–§;3974390.0;2462809.0;15742253.0;7950181.0
01.04.2025;B2G;–ë–£–ü;0.0;0.0;107142857.0;
01.04.2025;B2G;–í–§;15537728.0;5746151.0;55241769.0;17952836.0
01.04.2025;B2G;–ì–û;16732650.0;0.0;26138957.0;
01.04.2025;B2G;–ó–§;11555440.0;4951993.0;40970195.0;20066183.0
01.04.2025;B2G;–ö–§;14494483.0;12379184.0;49131025.0;48642642.0
01.04.2025;B2G;–ú–§;16254237.0;13770677.0;55445937.0;54208822.0
01.04.2025;B2G;–°–¢–°;615217.0;700753.0;1781403.0;2152419.0
01.04.2025;B2G;–£–§;10906740.0;1428314.0;23107861.0;6706864.0
01.04.2025;B2G;–®–§;8453383.0;6049309.0;32539837.0;18737621.0
01.04.2025;B2G;–Æ–§;14567540.0;6278824.0;54212368.0;75682098.0
01.04.2025;B2O;–ê–°;1506205.0;4700588.0;5475456.0;10639242.0
01.04.2025;B2O;–ê–§;4637786.0;8501873.0;18072746.0;27173332.0
01.04.2025;B2O;–í–§;1863960.0;4616992.0;7263570.0;8152711.0
01.04.2025;B2O;–ì–û;620903050.0;730838057.0;2492301549.0;2653688684.0
01.04.2025;B2O;–ó–§;8184563.0;8563118.0;32324640.0;33740320.0
01.04.2025;B2O;–ö–§;279062.0;217451.0;1087460.0;847955.0
01.04.2025;B2O;–ú–§;31599623.0;31610090.0;123662842.0;123615575.0
01.04.2025;B2O;–°–¢–°;645609.0;343855.0;2404265.0;1540127.0
01.04.2025;B2O;–£–§;3722262.0;7428381.0;14896478.0;25955484.0
01.04.2025;B2O;–®–§;16703994.0;20222672.0;65035394.0;85010202.0
01.04.2025;B2O;–Æ–§;5137254.0;4924611.0;20117999.0;19158076.0
01.05.2025;B2B;–ê–°;135650147.0;124793913.0;644376330.0;593797814.0
01.05.2025;B2B;–ê–§;55651064.0;58072534.0;269078725.0;290168400.0
01.05.2025;B2B;–ë–£–ü;0.0;202850645.0;792128138.0;244349649.0
01.05.2025;B2B;–í–§;20019064.0;17120193.0;93245972.0;86747633.0
01.05.2025;B2B;–ì–û;22172673.0;26376695.0;110863363.0;125001735.0
01.05.2025;B2B;–ó–§;167541098.0;151432285.0;840627224.0;795535670.0
01.05.2025;B2B;–ö–§;15450262.0;14140439.0;74013311.0;64851098.0
01.05.2025;B2B;–ú–§;79310569.0;76297545.0;389500114.0;356953687.0
01.05.2025;B2B;–°–¢–°;38965786.0;61086506.0;186350653.0;308335275.0
01.05.2025;B2B;–£–§;38776728.0;34204600.0;192400228.0;171961350.0
01.05.2025;B2B;–®–§;38307864.0;39033613.0;177530122.0;176113270.0
01.05.2025;B2B;–Æ–§;91541368.0;89872998.0;437513547.0;434874978.0
01.05.2025;B2C;–ê–°;799203.0;693968.0;4563236.0;3692484.0
01.05.2025;B2C;–ê–§;367449.0;228782.0;1792078.0;1151115.0
01.05.2025;B2C;–í–§;88201.0;60240.0;378550.0;320788.0
01.05.2025;B2C;–ó–§;743432.0;1052580.0;3524858.0;5169708.0
01.05.2025;B2C;–ú–§;587627.0;472230.0;3015694.0;2308171.0
01.05.2025;B2C;–°–¢–°;465407.0;206510.0;2372753.0;1060919.0
01.05.2025;B2C;–£–§;175216.0;106664.0;906572.0;541967.0
01.05.2025;B2C;–Æ–§;15205.0;8170.0;77314.0;40848.0
01.05.2025;B2G;–ê–°;65326762.0;34680853.0;284658296.0;154124342.0
01.05.2025;B2G;–ê–§;3977098.0;2950677.0;19719352.0;10900858.0
01.05.2025;B2G;–ë–£–ü;0.0;0.0;107142857.0;
01.05.2025;B2G;–í–§;15537728.0;7006783.0;70779497.0;24959619.0
01.05.2025;B2G;–ì–û;16732650.0;0.0;42871607.0;
01.05.2025;B2G;–ó–§;11555440.0;3960650.0;52525635.0;24026833.0
01.05.2025;B2G;–ö–§;14494464.0;10040953.0;63625489.0;58683595.0
01.05.2025;B2G;–ú–§;16949968.0;14411114.0;72395905.0;68619936.0
01.05.2025;B2G;–°–¢–°;615217.0;977574.0;2396620.0;3129993.0
01.05.2025;B2G;–£–§;11328780.0;1427635.0;34436641.0;8134499.0
01.05.2025;B2G;–®–§;10151932.0;5480473.0;42691769.0;24218094.0
01.05.2025;B2G;–Æ–§;15552489.0;7077149.0;69764857.0;82759247.0
01.05.2025;B2O;–ê–°;1597767.0;1777016.0;7073222.0;12416257.0
01.05.2025;B2O;–ê–§;4717518.0;8007056.0;22790264.0;35180388.0
01.05.2025;B2O;–í–§;1896005.0;1980575.0;9159575.0;10133286.0
01.05.2025;B2O;–ì–û;675011456.0;664486253.0;3167313005.0;3318174937.0
01.05.2025;B2O;–ó–§;8253497.0;10813896.0;40578138.0;44554216.0
01.05.2025;B2O;–ö–§;283859.0;217451.0;1371320.0;1065406.0
01.05.2025;B2O;–ú–§;32055565.0;31532161.0;155718407.0;155147736.0
01.05.2025;B2O;–°–¢–°;675304.0;343855.0;3079569.0;1883982.0
01.05.2025;B2O;–£–§;3721023.0;7267415.0;18617502.0;33222899.0
01.05.2025;B2O;–®–§;17000757.0;11502288.0;82036151.0;96512490.0
01.05.2025;B2O;–Æ–§;5209090.0;3618793.0;25327089.0;22776869.0
01.06.2025;B2B;–ê–°;139075572.0;121666801.0;783451903.0;715464615.0
01.06.2025;B2B;–ê–§;56616217.0;57072517.0;325694942.0;347240917.0
01.06.2025;B2B;–ë–£–ü;0.0;0.0;792128138.0;244349649.0
01.06.2025;B2B;–í–§;19680513.0;16874163.0;112926485.0;103621795.0
01.06.2025;B2B;–ì–û;22172673.0;26321198.0;133036035.0;151322933.0
01.06.2025;B2B;–ó–§;167541785.0;159364150.0;1008169009.0;954899821.0
01.06.2025;B2B;–ö–§;15771497.0;14421796.0;89784808.0;79272893.0
01.06.2025;B2B;–ú–§;80036206.0;71802495.0;469536320.0;428756182.0
01.06.2025;B2B;–°–¢–°;39850637.0;59843783.0;226201290.0;368179058.0
01.06.2025;B2B;–£–§;38863609.0;34976430.0;231263837.0;206937780.0
01.06.2025;B2B;–®–§;39977669.0;39375560.0;217507791.0;215488830.0
01.06.2025;B2B;–Æ–§;93600711.0;112818466.0;531114258.0;547693444.0
01.06.2025;B2C;–ê–°;752102.0;680624.0;5315337.0;4373108.0
01.06.2025;B2C;–ê–§;371982.0;228983.0;2164060.0;1380098.0
01.06.2025;B2C;–í–§;85732.0;60103.0;464282.0;380891.0
01.06.2025;B2C;–ó–§;763384.0;1033291.0;4288241.0;6203000.0
01.06.2025;B2C;–ú–§;581222.0;500371.0;3596916.0;2808542.0
01.06.2025;B2C;–°–¢–°;460927.0;204014.0;2833680.0;1264933.0
01.06.2025;B2C;–£–§;172270.0;106668.0;1078842.0;648635.0
01.06.2025;B2C;–Æ–§;15079.0;8170.0;92394.0;49018.0
01.06.2025;B2G;–ê–°;65334520.0;34342577.0;349992817.0;188466919.0
01.06.2025;B2G;–ê–§;3980186.0;7951331.0;23699538.0;18852189.0
01.06.2025;B2G;–ë–£–ü;0.0;0.0;107142857.0;
01.06.2025;B2G;–í–§;15537728.0;6242744.0;86317226.0;31202363.0
01.06.2025;B2G;–ì–û;16732650.0;0.0;59604257.0;
01.06.2025;B2G;–ó–§;11555440.0;3889787.0;64081075.0;27916620.0
01.06.2025;B2G;–ö–§;14494444.0;10116113.0;78119933.0;68799708.0
01.06.2025;B2G;–ú–§;16249451.0;13651658.0;88645356.0;82271594.0
01.06.2025;B2G;–°–¢–°;615217.0;1530617.0;3011836.0;4660610.0
01.06.2025;B2G;–£–§;10906417.0;1490355.0;45343058.0;9624854.0
01.06.2025;B2G;–®–§;8453383.0;4832524.0;51145152.0;29050618.0
01.06.2025;B2G;–Æ–§;14572543.0;6077726.0;84337399.0;88836973.0
01.06.2025;B2O;–ê–°;1689328.0;-4063515.0;8762550.0;8352742.0
01.06.2025;B2O;–ê–§;4797251.0;6183932.0;27587515.0;41364320.0
01.06.2025;B2O;–í–§;1928050.0;2745975.0;11087625.0;12879261.0
01.06.2025;B2O;–ì–û;685733540.0;686395913.0;3853046545.0;4004570850.0
01.06.2025;B2O;–ó–§;8322432.0;10529669.0;48900570.0;55083885.0
01.06.2025;B2O;–ö–§;288657.0;217451.0;1659976.0;1282857.0
01.06.2025;B2O;–ú–§;32511507.0;31290224.0;188229914.0;186437960.0
01.06.2025;B2O;–°–¢–°;704999.0;343855.0;3784568.0;2227838.0
01.06.2025;B2O;–£–§;3719785.0;6697528.0;22337286.0;39920427.0
01.06.2025;B2O;–®–§;17297521.0;9991608.0;99333672.0;106504098.0
01.06.2025;B2O;–Æ–§;5280926.0;447773.0;30608016.0;23224643.0
01.07.2025;B2B;–ê–°;143102928.0;132226424.0;926554831.0;847691039.0
01.07.2025;B2B;–ê–§;57613529.0;61330126.0;383308471.0;408571043.0
01.07.2025;B2B;–ë–£–ü;0.0;589277493.0;792128138.0;833627142.0
01.07.2025;B2B;–í–§;19237399.0;18300921.0;132163883.0;121922717.0
01.07.2025;B2B;–ì–û;22172673.0;35849960.0;155208708.0;187172893.0
01.07.2025;B2B;–ó–§;167547703.0;154259852.0;1175716711.0;1109159672.0
01.07.2025;B2B;–ö–§;16100996.0;15574303.0;105885804.0;94847197.0
01.07.2025;B2B;–ú–§;80773630.0;78843659.0;550309950.0;507599841.0
01.07.2025;B2B;–°–¢–°;40709326.0;61530221.0;266910616.0;429709280.0
01.07.2025;B2B;–£–§;38951788.0;35789671.0;270215625.0;242727452.0
01.07.2025;B2B;–®–§;41836482.0;35440877.0;259344273.0;250929707.0
01.07.2025;B2B;–Æ–§;95300803.0;103010247.0;626415061.0;650703691.0
01.07.2025;B2C;–ê–°;708174.0;708174.0;6023511.0;5081282.0
01.07.2025;B2C;–ê–§;376522.0;225586.0;2540582.0;1605684.0
01.07.2025;B2C;–í–§;93726.0;93726.0;558009.0;474617.0
01.07.2025;B2C;–ó–§;783889.0;783889.0;5072131.0;6986889.0
01.07.2025;B2C;–ú–§;574893.0;574893.0;4171809.0;3383435.0
01.07.2025;B2C;–°–¢–°;456491.0;456491.0;3290172.0;1721425.0
01.07.2025;B2C;–£–§;169375.0;169375.0;1248216.0;818009.0
01.07.2025;B2C;–Æ–§;14954.0;14954.0;107348.0;63972.0
01.07.2025;B2G;–ê–°;65342392.0;78320249.0;415335209.0;266787168.0
01.07.2025;B2G;–ê–§;4858794.0;3395055.0;28558332.0;22247244.0
01.07.2025;B2G;–ë–£–ü;0.0;0.0;107142857.0;
01.07.2025;B2G;–í–§;17287299.0;8070470.0;103604525.0;39272832.0
01.07.2025;B2G;–ì–û;16732650.0;7939944.0;76336907.0;7939944.0
01.07.2025;B2G;–ó–§;11555440.0;7833333.0;75636515.0;35749953.0
01.07.2025;B2G;–ö–§;15708855.0;14052701.0;93828788.0;82852410.0
01.07.2025;B2G;–ú–§;16249189.0;15057163.0;104894545.0;97328757.0
01.07.2025;B2G;–°–¢–°;615217.0;615217.0;3627053.0;5275826.0
01.07.2025;B2G;–£–§;10906417.0;2101116.0;56249475.0;11725970.0
01.07.2025;B2G;–®–§;8453383.0;9142632.0;59598535.0;38193249.0
01.07.2025;B2G;–Æ–§;16402842.0;11869456.0;100740242.0;100706429.0
01.07.2025;B2O;–ê–°;1780889.0;1780889.0;10543438.0;10133631.0
01.07.2025;B2O;–ê–§;4876984.0;8501873.0;32464499.0;49866194.0
01.07.2025;B2O;–í–§;1960096.0;1960096.0;13047721.0;14839356.0
01.07.2025;B2O;–ì–û;720528468.0;720604717.0;4573575013.0;4725175567.0
01.07.2025;B2O;–ó–§;8391367.0;8398967.0;57291938.0;63482852.0
01.07.2025;B2O;–ö–§;293454.0;255951.0;1953431.0;1538808.0
01.07.2025;B2O;–ú–§;32967449.0;31316957.0;221197363.0;217754916.0
01.07.2025;B2O;–°–¢–°;734694.0;734694.0;4519262.0;2962532.0
01.07.2025;B2O;–£–§;3718546.0;8133000.0;26055832.0;48053427.0
01.07.2025;B2O;–®–§;17594284.0;17766611.0;116927956.0;124270709.0
01.07.2025;B2O;–Æ–§;5352763.0;5352763.0;35960778.0;28577405.0
01.08.2025;B2B;–ê–°;147485842.0;132672731.0;1074040673.0;980363770.0
01.08.2025;B2B;–ê–§;58541072.0;62329224.0;441849542.0;470900267.0
01.08.2025;B2B;–ë–£–ü;0.0;0.0;792128138.0;833627142.0
01.08.2025;B2B;–í–§;19125774.0;21367619.0;151289657.0;143290335.0
01.08.2025;B2B;–ì–û;22172673.0;31817940.0;177381380.0;218990834.0
01.08.2025;B2B;–ó–§;167276232.0;154742414.0;1342992943.0;1263902086.0
01.08.2025;B2B;–ö–§;16438520.0;15691818.0;122324324.0;110539014.0
01.08.2025;B2B;–ú–§;81522082.0;79243290.0;631832032.0;586843131.0
01.08.2025;B2B;–°–¢–°;41500812.0;61896973.0;308411428.0;491606253.0
01.08.2025;B2B;–£–§;39038504.0;36236907.0;309254129.0;278964359.0
01.08.2025;B2B;–®–§;43284313.0;35634878.0;302628586.0;286564585.0
01.08.2025;B2B;–Æ–§;97053790.0;103868519.0;723468851.0;754572210.0
01.08.2025;B2C;–ê–°;666800.0;666800.0;6690310.0;5748081.0
01.08.2025;B2C;–ê–§;381070.0;227880.0;2921652.0;1833564.0
01.08.2025;B2C;–í–§;91203.0;91203.0;649212.0;565820.0
01.08.2025;B2C;–ó–§;804963.0;804963.0;5877094.0;7791852.0
01.08.2025;B2C;–ú–§;568627.0;568627.0;4740436.0;3952062.0
01.08.2025;B2C;–°–¢–°;452100.0;452100.0;3742272.0;2173525.0
01.08.2025;B2C;–£–§;166529.0;166529.0;1414745.0;984538.0
01.08.2025;B2C;–Æ–§;14831.0;14831.0;122179.0;78803.0
01.08.2025;B2G;–ê–°;65350377.0;78329881.0;480685586.0;345117049.0
01.08.2025;B2G;–ê–§;6148555.0;3160436.0;34706887.0;25407680.0
01.08.2025;B2G;–ë–£–ü;0.0;0.0;107142857.0;
01.08.2025;B2G;–í–§;19159225.0;9320513.0;122763750.0;48593345.0
01.08.2025;B2G;–ì–û;16732650.0;138925300.0;93069557.0;146865244.0
01.08.2025;B2G;–ó–§;11555440.0;5496456.0;87191955.0;41246409.0
01.08.2025;B2G;–ö–§;17154881.0;15088987.0;110983669.0;97941397.0
01.08.2025;B2G;–ú–§;16947099.0;15203557.0;121841645.0;112532314.0
01.08.2025;B2G;–°–¢–°;615217.0;615217.0;4242270.0;5891043.0
01.08.2025;B2G;–£–§;11328780.0;1461645.0;67578256.0;13187615.0
01.08.2025;B2G;–®–§;10151932.0;8358955.0;69750467.0;46552204.0
01.08.2025;B2G;–Æ–§;20212494.0;10815360.0;120952736.0;111521790.0
01.08.2025;B2O;–ê–°;1872450.0;1872450.0;12415888.0;12006081.0
01.08.2025;B2O;–ê–§;4956716.0;8501873.0;37421215.0;58368067.0
01.08.2025;B2O;–í–§;1992141.0;1992141.0;15039862.0;16831497.0
01.08.2025;B2O;–ì–û;717636105.0;717712355.0;5291211118.0;5442887922.0
01.08.2025;B2O;–ó–§;8460302.0;8467902.0;65752240.0;71950755.0
01.08.2025;B2O;–ö–§;298252.0;895951.0;2251683.0;2434759.0
01.08.2025;B2O;–ú–§;33423391.0;31316957.0;254620753.0;249071873.0
01.08.2025;B2O;–°–¢–°;764390.0;764390.0;5283652.0;3726921.0
01.08.2025;B2O;–£–§;3717307.0;8340000.0;29773139.0;56393427.0
01.08.2025;B2O;–®–§;17891048.0;18063375.0;134819004.0;142334083.0
01.08.2025;B2O;–Æ–§;5424599.0;5424599.0;41385377.0;34002004.0
01.09.2025;B2B;–ê–°;350604676.0;133485603.0;1424645349.0;1113849373.0
01.09.2025;B2B;–ê–§;59439368.0;63331449.0;501288910.0;534231716.0
01.09.2025;B2B;–ë–£–ü;100000000.0;0.0;892128138.0;833627142.0
01.09.2025;B2B;–í–§;21296654.0;21587206.0;172586312.0;164877541.0
01.09.2025;B2B;–ì–û;22172673.0;47925133.0;199554053.0;266915967.0
01.09.2025;B2B;–ó–§;273112184.0;268602136.0;1616105127.0;1532504222.0
01.09.2025;B2B;–ö–§;16786446.0;15810305.0;139110769.0;126349319.0
01.09.2025;B2B;–ú–§;82188883.0;79645872.0;714020915.0;666489003.0
01.09.2025;B2B;–°–¢–°;42314670.0;62289837.0;350726098.0;553896089.0
01.09.2025;B2B;–£–§;39125442.0;36692455.0;348379571.0;315656813.0
01.09.2025;B2B;–®–§;44458201.0;36179771.0;347086786.0;322744356.0
01.09.2025;B2B;–Æ–§;98446478.0;104652360.0;821915329.0;859224570.0
01.09.2025;B2C;–ê–°;630147.0;630147.0;7320457.0;6378228.0
01.09.2025;B2C;–ê–§;385626.0;230197.0;3307278.0;2063761.0
01.09.2025;B2C;–í–§;99001.0;99001.0;748213.0;664821.0
01.09.2025;B2C;–ó–§;826621.0;826621.0;6703715.0;8618473.0
01.09.2025;B2C;–ú–§;562420.0;562420.0;5302857.0;4514483.0
01.09.2025;B2C;–°–¢–°;447753.0;447753.0;4190025.0;2621278.0
01.09.2025;B2C;–£–§;163732.0;163732.0;1578476.0;1148270.0
01.09.2025;B2C;–Æ–§;14708.0;14708.0;136887.0;93511.0
01.09.2025;B2G;–ê–°;65358479.0;78336463.0;546044065.0;423453512.0
01.09.2025;B2G;–ê–§;8014545.0;2564221.0;42721432.0;27971901.0
01.09.2025;B2G;–ë–£–ü;0.0;0.0;107142857.0;
01.09.2025;B2G;–í–§;21164014.0;8070470.0;143927764.0;56663815.0
01.09.2025;B2G;–ì–û;16732650.0;154656861.0;109802207.0;301522104.0
01.09.2025;B2G;–ó–§;11555440.0;5496456.0;98747395.0;46742864.0
01.09.2025;B2G;–ö–§;18868970.0;15089012.0;129852640.0;113030409.0
01.09.2025;B2G;–ú–§;16248763.0;14437121.0;138090408.0;126969435.0
01.09.2025;B2G;–°–¢–°;615217.0;615217.0;4857487.0;6506260.0
01.09.2025;B2G;–£–§;10906417.0;1461645.0;78484673.0;14649260.0
01.09.2025;B2G;–®–§;8453383.0;7985802.0;78203850.0;54538006.0
01.09.2025;B2G;–Æ–§;23522904.0;9767607.0;144475640.0;121289396.0
01.09.2025;B2O;–ê–°;1964011.0;1964011.0;14379899.0;13970091.0
01.09.2025;B2O;–ê–§;5036449.0;8501873.0;42457664.0;66869940.0
01.09.2025;B2O;–í–§;2024186.0;2024186.0;17064048.0;18855683.0
01.09.2025;B2O;–ì–û;721636105.0;721712355.0;6012847224.0;6164600276.0
01.09.2025;B2O;–ó–§;8529237.0;8536837.0;74281477.0;80487592.0
01.09.2025;B2O;–ö–§;303050.0;895951.0;2554733.0;3330710.0
01.09.2025;B2O;–ú–§;33879333.0;31316957.0;288500086.0;280388829.0
01.09.2025;B2O;–°–¢–°;794085.0;794085.0;6077737.0;4521006.0
01.09.2025;B2O;–£–§;3716069.0;8340000.0;33489208.0;64733427.0
01.09.2025;B2O;–®–§;18187811.0;18360138.0;153006816.0;160694221.0
01.09.2025;B2O;–Æ–§;5496435.0;5496435.0;46881812.0;39498439.0
01.10.2025;B2B;–ê–°;154780578.0;134722235.0;1579425926.0;1248571608.0
01.10.2025;B2B;–ê–§;60399102.0;64331587.0;561688012.0;598563303.0
01.10.2025;B2B;–ë–£–ü;0.0;0.0;892128138.0;833627142.0
01.10.2025;B2B;–í–§;21664253.0;21810087.0;194250565.0;186687628.0
01.10.2025;B2B;–ì–û;34185021.0;59937481.0;233739074.0;326853448.0
01.10.2025;B2B;–ó–§;166678738.0;155699053.0;1782783865.0;1688203275.0
01.10.2025;B2B;–ö–§;17144098.0;15929772.0;156254868.0;142279092.0
01.10.2025;B2B;–ú–§;82749345.0;80051426.0;796770260.0;746540429.0
01.10.2025;B2B;–°–¢–°;43118431.0;62683616.0;393844529.0;616579705.0
01.10.2025;B2B;–£–§;39217729.0;37140055.0;387597300.0;352796868.0
01.10.2025;B2B;–®–§;45642827.0;36625160.0;392729614.0;359369516.0
01.10.2025;B2B;–Æ–§;100101896.0;105518009.0;922017225.0;964742579.0
01.10.2025;B2C;–ê–°;596015.0;596015.0;7916472.0;6974243.0
01.10.2025;B2C;–ê–§;390190.0;232538.0;3697468.0;2296299.0
01.10.2025;B2C;–í–§;96425.0;96425.0;844637.0;761245.0
01.10.2025;B2C;–ó–§;848879.0;848879.0;7552594.0;9467352.0
01.10.2025;B2C;–ú–§;556269.0;556269.0;5859126.0;5070752.0
01.10.2025;B2C;–°–¢–°;443449.0;443449.0;4633474.0;3064727.0
01.10.2025;B2C;–£–§;160982.0;160982.0;1739459.0;1309252.0
01.10.2025;B2C;–Æ–§;14587.0;14587.0;151474.0;108099.0
01.10.2025;B2G;–ê–°;65366698.0;78348059.0;611410763.0;501801571.0
01.10.2025;B2G;–ê–§;10684144.0;3395250.0;53405577.0;31367150.0
01.10.2025;B2G;–ë–£–ü;0.0;0.0;107142857.0;
01.10.2025;B2G;–í–§;23313016.0;8070470.0;167240779.0;64734284.0
01.10.2025;B2G;–ì–û;27515983.0;143451952.0;137318190.0;444974056.0
01.10.2025;B2G;–ó–§;11555440.0;7833333.0;110302835.0;54576197.0
01.10.2025;B2G;–ö–§;20892807.0;15568913.0;150745447.0;128599322.0
01.10.2025;B2G;–ú–§;16248598.0;15057163.0;154339005.0;142026598.0
01.10.2025;B2G;–°–¢–°;615217.0;615217.0;5472704.0;7121477.0
01.10.2025;B2G;–£–§;10906417.0;2101116.0;89391090.0;16750376.0
01.10.2025;B2G;–®–§;8453383.0;9142632.0;86657233.0;63680638.0
01.10.2025;B2G;–Æ–§;30272573.0;11877779.0;174748212.0;133167176.0
01.10.2025;B2O;–ê–°;2055572.0;2055572.0;16435471.0;16025663.0
01.10.2025;B2O;–ê–§;5116182.0;8501873.0;47573846.0;75371814.0
01.10.2025;B2O;–í–§;2056231.0;2056231.0;19120279.0;20911914.0
01.10.2025;B2O;–ì–û;725636105.0;725712355.0;6738483329.0;6890312631.0
01.10.2025;B2O;–ó–§;8598172.0;8605772.0;82879649.0;89093364.0
01.10.2025;B2O;–ö–§;307847.0;895951.0;2862580.0;4226661.0
01.10.2025;B2O;–ú–§;34335274.0;31316957.0;322835360.0;311705786.0
01.10.2025;B2O;–°–¢–°;823780.0;823780.0;6901517.0;5344786.0
01.10.2025;B2O;–£–§;3714830.0;8550000.0;37204038.0;73283427.0
01.10.2025;B2O;–®–§;18484575.0;18656902.0;171491391.0;179351123.0
01.10.2025;B2O;–Æ–§;5568271.0;5568271.0;52450083.0;45066710.0
01.11.2025;B2B;–ê–°;158356612.0;398200285.0;1737782538.0;1646771893.0
01.11.2025;B2B;–ê–§;61384916.0;65329877.0;623072928.0;663893180.0
01.11.2025;B2B;–ë–£–ü;0.0;0.0;892128138.0;833627142.0
01.11.2025;B2B;–í–§;22042459.0;22036311.0;216293024.0;208723939.0
01.11.2025;B2B;–ì–û;44185021.0;69937481.0;277924094.0;396790928.0
01.11.2025;B2B;–ó–§;230357387.0;220173266.0;2013141251.0;1908376541.0
01.11.2025;B2B;–ö–§;17511740.0;16050226.0;173766608.0;158329318.0
01.11.2025;B2B;–ú–§;83352831.0;80459968.0;880123091.0;827000397.0
01.11.2025;B2B;–°–¢–°;43949160.0;63078315.0;437793690.0;679658020.0
01.11.2025;B2B;–£–§;39307639.0;37590900.0;426904939.0;390387769.0
01.11.2025;B2B;–®–§;46877043.0;36825502.0;439606657.0;396195018.0
01.11.2025;B2B;–Æ–§;101501594.0;106407665.0;1023518819.0;1071150244.0
01.11.2025;B2C;–ê–°;563824.0;563824.0;8480296.0;7538067.0
01.11.2025;B2C;–ê–§;394762.0;234903.0;4092230.0;2531202.0
01.11.2025;B2C;–í–§;104031.0;104031.0;948668.0;865276.0
01.11.2025;B2C;–ó–§;871754.0;871754.0;8424348.0;10339106.0
01.11.2025;B2C;–ú–§;550174.0;550174.0;6409300.0;5620926.0
01.11.2025;B2C;–°–¢–°;439188.0;439188.0;5072662.0;3503915.0
01.11.2025;B2C;–£–§;158280.0;158280.0;1897738.0;1467532.0
01.11.2025;B2C;–Æ–§;14467.0;14467.0;165942.0;122566.0
01.11.2025;B2G;–ê–°;65375036.0;78344580.0;676785798.0;580146151.0
01.11.2025;B2G;–ê–§;14469841.0;3160633.0;67875418.0;34527783.0
01.11.2025;B2G;–ë–£–ü;0.0;107142857.0;107142857.0;107142857.0
01.11.2025;B2G;–í–§;25135332.0;9320513.0;192376111.0;74054797.0
01.11.2025;B2G;–ì–û;27515983.0;90533000.0;164834174.0;535507056.0
01.11.2025;B2G;–ó–§;11555440.0;5496456.0;121858275.0;60072653.0
01.11.2025;B2G;–ö–§;23274027.0;15089062.0;174019474.0;143688384.0
01.11.2025;B2G;–ú–§;16944514.0;15203557.0;171283519.0;157230155.0
01.11.2025;B2G;–°–¢–°;615217.0;615217.0;6087920.0;7736693.0
01.11.2025;B2G;–£–§;11328780.0;1461645.0;100719870.0;18212022.0
01.11.2025;B2G;–®–§;10151932.0;8358955.0;96809165.0;72039593.0
01.11.2025;B2G;–Æ–§;41817851.0;10823933.0;216566063.0;143991108.0
01.11.2025;B2O;–ê–°;2147133.0;2147133.0;18582603.0;18172796.0
01.11.2025;B2O;–ê–§;5195914.0;8501873.0;52769760.0;83873687.0
01.11.2025;B2O;–í–§;2088276.0;2088276.0;21208555.0;23000190.0
01.11.2025;B2O;–ì–û;729036105.0;729112355.0;7467519434.0;7619424986.0
01.11.2025;B2O;–ó–§;8667107.0;8674707.0;91546756.0;97768071.0
01.11.2025;B2O;–ö–§;312645.0;895951.0;3175225.0;5122612.0
01.11.2025;B2O;–ú–§;34791216.0;31316957.0;357626577.0;343022742.0
01.11.2025;B2O;–°–¢–°;853475.0;853475.0;7754992.0;6198261.0
01.11.2025;B2O;–£–§;3713592.0;8750000.0;40917630.0;82033427.0
01.11.2025;B2O;–®–§;18781339.0;18953665.0;190272729.0;198304788.0
01.11.2025;B2O;–Æ–§;5640107.0;5640107.0;58090191.0;50706817.0
01.12.2025;B2B;–ê–°;162075630.0;135680734.0;1899858168.0;1782452627.0
01.12.2025;B2B;–ê–§;62397809.0;66330640.0;685470737.0;730223820.0
01.12.2025;B2B;–ë–£–ü;0.0;0.0;892128138.0;833627142.0
01.12.2025;B2B;–í–§;22425448.0;22265928.0;238718471.0;230989867.0
01.12.2025;B2B;–ì–û;34185021.0;59937481.0;312109115.0;456728409.0
01.12.2025;B2B;–ó–§;165774117.0;164024841.0;2178915369.0;2072401382.0
01.12.2025;B2B;–ö–§;17811446.0;16171674.0;191578054.0;174500992.0
01.12.2025;B2B;–ú–§;83867656.0;80871518.0;963990747.0;907871915.0
01.12.2025;B2B;–°–¢–°;44748848.0;63473940.0;482542537.0;743131959.0
01.12.2025;B2B;–£–§;39288168.0;37892303.0;466193107.0;428280071.0
01.12.2025;B2B;–®–§;48118465.0;36934664.0;487725121.0;433129682.0
01.12.2025;B2B;–Æ–§;102912596.0;107359346.0;1126431415.0;1178509590.0
01.12.2025;B2C;–ê–°;533456.0;533456.0;9013752.0;8071523.0
01.12.2025;B2C;–ê–§;399341.0;237292.0;4491571.0;2768494.0
01.12.2025;B2C;–í–§;101405.0;101405.0;1050073.0;966681.0
01.12.2025;B2C;–ó–§;895264.0;895264.0;9319612.0;11234370.0
01.12.2025;B2C;–ú–§;544797.0;544797.0;6954097.0;6165723.0
01.12.2025;B2C;–°–¢–°;434970.0;434970.0;5507632.0;3938886.0
01.12.2025;B2C;–£–§;155624.0;155624.0;2053362.0;1623155.0
01.12.2025;B2C;–Æ–§;14348.0;14348.0;180290.0;136914.0
01.12.2025;B2G;–ê–°;65183494.0;78160248.0;741969293.0;658306399.0
01.12.2025;B2G;–ê–§;19800261.0;2564420.0;87675679.0;37092203.0
01.12.2025;B2G;–ë–£–ü;0.0;0.0;107142857.0;107142857.0
01.12.2025;B2G;–í–§;27127370.0;8070470.0;219503481.0;82125266.0
01.12.2025;B2G;–ì–û;27515983.0;33949875.0;192350157.0;569456931.0
01.12.2025;B2G;–ó–§;11555440.0;5496456.0;133413715.0;65569109.0
01.12.2025;B2G;–ö–§;26067021.0;15089088.0;200086496.0;158777472.0
01.12.2025;B2G;–ú–§;16390254.0;14437121.0;187673773.0;171667276.0
01.12.2025;B2G;–°–¢–°;615217.0;615217.0;6703137.0;8351910.0
01.12.2025;B2G;–£–§;10906417.0;1461645.0;111626287.0;19673667.0
01.12.2025;B2G;–®–§;8453383.0;7985802.0;105262548.0;80025394.0
01.12.2025;B2G;–Æ–§;57229178.0;9776437.0;273795241.0;153767545.0
01.12.2025;B2O;–ê–°;2238694.0;2238694.0;20821297.0;20411490.0
01.12.2025;B2O;–ê–§;5275647.0;8501873.0;58045408.0;92375561.0
01.12.2025;B2O;–í–§;2120321.0;2120321.0;23328876.0;25120512.0
01.12.2025;B2O;–ì–û;732436105.0;732512355.0;8199955539.0;8351937340.0
01.12.2025;B2O;–ó–§;8736042.0;8743642.0;100282799.0;106511713.0
01.12.2025;B2O;–ö–§;317443.0;895951.0;3492667.0;6018563.0
01.12.2025;B2O;–ú–§;35247158.0;31316957.0;392873735.0;374339699.0
01.12.2025;B2O;–°–¢–°;883170.0;883170.0;8638162.0;7081431.0
01.12.2025;B2O;–£–§;3712353.0;8800000.0;44629983.0;90833427.0
01.12.2025;B2O;–®–§;19078102.0;19250429.0;209350831.0;217555217.0
01.12.2025;B2O;–Æ–§;5711944.0;5711944.0;63802134.0;56418761.0
`;

/* ===== –£—Ç–∏–ª–∏—Ç—ã ===== */
const parseDate = s => { const [d,m,y] = s.split('.'); return new Date(`${y}-${m}-${d}T00:00:00`) };
const fmt  = new Intl.NumberFormat('ru-RU',{maximumFractionDigits:2});
const fmtP = new Intl.NumberFormat('ru-RU',{maximumFractionDigits:1});
const uniq = a => [...new Set(a)];
const NEED = ['Date','Conssegm','Fil','plan','fact','plan_full','fact_full'];

function splitCSVLine(line, delim){
  const out=[]; let cur='', q=false;
  for(let i=0;i<line.length;i++){
    const ch=line[i];
    if(ch==='"'){ if(q && line[i+1]==='"'){ cur+='"'; i++; } else q=!q; }
    else if(ch===delim && !q){ out.push(cur); cur=''; }
    else cur+=ch;
  } out.push(cur); return out;
}
function parseCSV(text){
  let t=text; if(t.charCodeAt(0)===0xFEFF) t=t.slice(1);
  const delim = ';';
  const lines = t.split(/\r?\n/).filter(l=>l.trim().length>0);
  const header = splitCSVLine(lines[0], delim).map(h=>h.trim());
  const rows = lines.slice(1).map(ln => splitCSVLine(ln, delim));
  return {header, rows};
}

/* ===== –°–æ—Å—Ç–æ—è–Ω–∏–µ/DOM ===== */
let data=[];
const state = {
  dateList:[], dateIndex:0,
  collapsed:new Set(),
  segExcluded:new Set(), filExcluded:new Set(),
  allSeg:[], allFil:[]
};
const DOM = {
  slider: document.getElementById('dateSlider'),
  label:  document.getElementById('dateLabel'),
  thead:  document.getElementById('thead'),
  tbody:  document.getElementById('tbody'),
  tfoot:  document.getElementById('tfoot'),
  collapse: document.getElementById('collapseAll'),
  expand:   document.getElementById('expandAll'),
  downloadRaw:  document.getElementById('downloadCsvRaw'),
  status:   document.getElementById('status'),
  segChips: document.getElementById('segChips'),
  filChips: document.getElementById('filChips'),
  toggleSeg: document.getElementById('toggleSeg'),
  toggleFil: document.getElementById('toggleFil'),
};

/* ===== –§–∏–ª—å—Ç—Ä—ã: –∏—Å–∫–ª—é—á–µ–Ω–∏—è (toggle) + –∫–Ω–æ–ø–∫–∏-–∞–∫–∫–æ—Ä–¥–µ–æ–Ω—ã ===== */
function renderFilterChips(container, items, excludedSet){
  container.innerHTML='';
  // "–í—Å–µ" ‚Äî toggle: –µ—Å–ª–∏ —Å–µ–π—á–∞—Å –í–°–ï –∞–∫—Ç–∏–≤–Ω—ã (excluded –ø—É—Å—Ç–æ–π) ‚Üí –æ—Ç–∫–ª—é—á–∏—Ç—å –≤—Å—ë; –∏–Ω–∞—á–µ ‚Üí –≤–∫–ª—é—á–∏—Ç—å –≤—Å—ë
  const all = document.createElement('div');
  all.className='chip'+(excludedSet.size===0?' active':'');
  all.textContent='–í—Å–µ';
  all.onclick=()=>{
    if(excludedSet.size===0){ items.forEach(v=>excludedSet.add(v)); }
    else { excludedSet.clear(); }
    collapseAll(); render();
    renderFilterChips(container, items, excludedSet);
  };
  container.appendChild(all);

  items.forEach(v=>{
    const active = !excludedSet.has(v);
    const el=document.createElement('div'); el.className='chip'+(active?' active':''); el.textContent=v;
    el.onclick=()=>{ 
      if(excludedSet.has(v)) excludedSet.delete(v); else excludedSet.add(v);
      collapseAll(); render();
      renderFilterChips(container, items, excludedSet);
    };
    container.appendChild(el);
  });
}

// —Å–∫—Ä—ã—Ç—å/–ø–æ–∫–∞–∑–∞—Ç—å –±–ª–æ–∫–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –±–µ–∑ —Å–±—Ä–æ—Å–∞ –∑–Ω–∞—á–µ–Ω–∏–π
DOM.toggleSeg.onclick = ()=>{
  const open = DOM.toggleSeg.getAttribute('aria-expanded')==='true';
  DOM.toggleSeg.setAttribute('aria-expanded', String(!open));
  DOM.segChips.classList.toggle('hidden', open);
};
DOM.toggleFil.onclick = ()=>{
  const open = DOM.toggleFil.getAttribute('aria-expanded')==='true';
  DOM.toggleFil.setAttribute('aria-expanded', String(!open));
  DOM.filChips.classList.toggle('hidden', open);
};

/* ===== –ú–æ–¥–µ–ª—å/–ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ ===== */
/* –ü–æ—Ä—è–¥–æ–∫ –ø–æ–ª–µ–π: % –∑–∞—Ç–µ–º Œî (–∏ –¥–ª—è –∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã—Ö —Ç–æ–∂–µ). –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–ª–∏ –º–µ—Ç—Ä–∏–∫–∏. */
const metrics=[
  {k:'plan',t:'–ü–ª–∞–Ω –∑–∞ –ø–µ—Ä–∏–æ–¥'},
  {k:'fact',t:'–§–∞–∫—Ç –∑–∞ –ø–µ—Ä–∏–æ–¥'},
  {k:'pct',t:'%'},
  {k:'delta',t:'Œî'},
  {k:'plan_full',t:'–ü–ª–∞–Ω –∫—É–º.'},
  {k:'fact_full',t:'–§–∞–∫—Ç –∫—É–º.'},
  {k:'pct_full',t:'% –∫—É–º.'},
  {k:'delta_full',t:'Œî –∫—É–º.'},
];

function agg(arr){
  const pick = (key) => arr.map(x=>x[key]).filter(x=>x!=null);
  const sum  = (a) => a.reduce((s,v)=>s+v,0);
  const plan = sum(pick('plan'));
  const fact = sum(pick('fact'));
  const plan_full = sum(pick('plan_full'));
  const fact_full = sum(pick('fact_full'));
  const delta = (plan!=null && fact!=null) ? (fact-plan) : null;
  const pct   = plan ? (fact/plan*100) : null;
  const delta_full = (plan_full!=null && fact_full!=null) ? (fact_full - plan_full) : null;
  const pct_full   = plan_full ? (fact_full/plan_full*100) : null;
  return {plan,fact,delta,pct,plan_full,fact_full,delta_full,pct_full};
}
function currentDate(){ return state.dateList[state.dateIndex]; }
function applyFilter(rows){
  const ds=currentDate();
  const segActive = new Set(state.allSeg.filter(s=>!state.segExcluded.has(s)));
  const filActive = new Set(state.allFil.filter(f=>!state.filExcluded.has(f)));
  return rows.filter(r=> r.DateStr===ds && segActive.has(r.Conssegm) && filActive.has(r.Fil) );
}
function buildTree(rows){
  const bySeg = new Map();
  for(const r of rows){ if(!bySeg.has(r.Conssegm)) bySeg.set(r.Conssegm, []); bySeg.get(r.Conssegm).push(r); }
  const segs = [...bySeg.keys()].sort((a,b)=>String(a).localeCompare(String(b),'ru'));
  return segs.map(seg=>{
    const segRows = bySeg.get(seg);
    const byFil = new Map();
    for(const r of segRows){ if(!byFil.has(r.Fil)) byFil.set(r.Fil, []); byFil.get(r.Fil).push(r); }
    const fils = [...byFil.keys()].sort((a,b)=>String(a).localeCompare(String(b),'ru'));
    return {
      label:seg, level:0, path:`Conssegm=${seg}`, total:agg(segRows),
      children: fils.map(f=>({label:f, level:1, path:`Conssegm=${seg}|Fil=${f}`, total:agg(byFil.get(f)), children:[]}))
    };
  });
}

/* ===== –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ===== */
(function init(){
  try{
    const {header, rows} = parseCSV(CSV_TEXT);
    const normalizeHeader = s => s.replace(/^\uFEFF/,'').trim().replace(/^"(.*)"$/,'$1').normalize('NFKC');
    const headerNorm = header.map(normalizeHeader);
    const lc = headerNorm.map(h=>h.toLowerCase());
    const needLC = NEED.map(n=>n.toLowerCase());
    const miss = needLC.filter(n=>!lc.includes(n));
    if(miss.length){ console.error('Parsed header:', headerNorm); throw new Error('–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫–æ–ª–æ–Ω–∫–∏: '+miss.join(', ')); }
    const idx = Object.fromEntries(needLC.map((n,k)=>[NEED[k], lc.indexOf(n)]));

    data = rows.map(r=>{
      const ds=(r[idx.Date]??'').trim(), cs=(r[idx.Conssegm]??'').trim(), fl=(r[idx.Fil]??'').trim();
      const pl =(r[idx.plan]??'').replace(/\s/g,''), fc =(r[idx.fact]??'').replace(/\s/g,'');
      const plf=(r[idx.plan_full]??'').replace(/\s/g,''), fcf=(r[idx.fact_full]??'').replace(/\s/g,'');
      return {
        DateStr:ds, Date: ds?parseDate(ds):null, Conssegm:cs, Fil:fl,
        plan: pl? +pl.replace(',','.') : null,
        fact: fc? +fc.replace(',','.') : null,
        plan_full: plf? +plf.replace(',','.') : null,
        fact_full: fcf? +fcf.replace(',','.') : null
      };
    }).filter(x=>x.DateStr && x.Conssegm && x.Fil);

    // –î–∞—Ç—ã
    state.dateList = uniq(data.map(d=>d.DateStr)).sort((a,b)=>parseDate(a)-parseDate(b));
    state.dateIndex = Math.max(0, state.dateList.length-1);
    DOM.slider.min=0; DOM.slider.max=Math.max(0,state.dateList.length-1);
    DOM.slider.value=state.dateIndex; DOM.slider.disabled = state.dateList.length<=1;
    DOM.label.textContent = state.dateList[state.dateIndex];

    // –§–∏–ª—å—Ç—Ä—ã
    state.allSeg = uniq(data.map(d=>d.Conssegm)).sort();
    state.allFil = uniq(data.map(d=>d.Fil)).sort((a,b)=>a.localeCompare(b,'ru'));
    renderFilterChips(DOM.segChips, state.allSeg, state.segExcluded);
    renderFilterChips(DOM.filChips, state.allFil, state.filExcluded);

    DOM.collapse.disabled=false; DOM.expand.disabled=false;

    collapseAll();
    render();
    DOM.status.textContent = `–°—Ç—Ä–æ–∫: ${data.length.toLocaleString('ru-RU')} ‚Ä¢ –î–∞—Ç: ${state.dateList.length}`;
  }catch(e){
    console.error(e);
    DOM.status.innerHTML = '<span style="color:#ff6a6a">–û—à–∏–±–∫–∞: '+(e.message||e)+'</span>';
  }
})();

/* ===== –†–µ–Ω–¥–µ—Ä ===== */
function render(){
  const rows = applyFilter(data);
  const tree = buildTree(rows);
  DOM.thead.innerHTML=''; DOM.tbody.innerHTML=''; DOM.tfoot.innerHTML='';

  // –®–∞–ø–∫–∞: 1-—è —Å—Ç—Ä–æ–∫–∞ sticky, 2-—è –æ–±—ã—á–Ω–∞—è. –ó–∞–≥–æ–ª–æ–≤–∫–∏ –º–µ—Ç—Ä–∏–∫ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–µ–º –≤–ø—Ä–∞–≤–æ.
  const tr1=document.createElement('tr'), tr2=document.createElement('tr');
  const thL=document.createElement('th'); thL.textContent='–°—Ç—Ä–æ–∫–∏'; thL.rowSpan=2; tr1.appendChild(thL);
  const thI=document.createElement('th'); thI.textContent='–ò—Ç–æ–≥–æ'; thI.colSpan=String(metrics.length); tr1.appendChild(thI);
  metrics.forEach(m=>{ const th=document.createElement('th'); th.textContent=m.t; th.className='metric'; tr2.appendChild(th); });
  DOM.thead.appendChild(tr1); DOM.thead.appendChild(tr2);

  const paint = (td,k,v)=>{ if((k==='delta'||k==='delta_full') && v!=null) td.classList.add(v>=0?'green':'red'); if((k==='pct'||k==='pct_full') && v!=null) td.classList.add(v>=100?'green':'red'); };

  function push(node){
    const tr=document.createElement('tr');
    const td=document.createElement('td'); const rc=document.createElement('div'); rc.className='rowcell';
    for(let i=0;i<node.level;i++){ const ind=document.createElement('span'); ind.className='indent'; rc.appendChild(ind); }
    const t=document.createElement('span'); t.className='toggle'+(node.children.length?'':' blank');
    t.textContent = state.collapsed.has(node.path)? '+' : '‚Äì';
    if(node.children.length){
      t.onclick = ()=>{ if(state.collapsed.has(node.path)) state.collapsed.delete(node.path); else state.collapsed.add(node.path); render(); };
    }
    rc.appendChild(t); const lbl=document.createElement('span'); lbl.textContent=node.label; rc.appendChild(lbl);
    td.appendChild(rc); tr.appendChild(td);

    for(const m of metrics){
      const v=node.total[m.k]; const c=document.createElement('td'); c.className='num';
      c.textContent = (m.k==='pct' || m.k==='pct_full') ? (v==null?'‚Äî':fmtP.format(v)+'%') : (v==null?'‚Äî':fmt.format(v));
      paint(c,m.k,v); tr.appendChild(c);
    }
    DOM.tbody.appendChild(tr);
    if(node.children.length && !state.collapsed.has(node.path)) node.children.forEach(push);
  }
  tree.forEach(push);

  // –ò—Ç–æ–≥ –ø–æ —Ç–µ–∫—É—â–µ–º—É –≤–∏–¥—É
  const tf=document.createElement('tr'); const tfl=document.createElement('td'); tfl.textContent='–ò—Ç–æ–≥ –ø–æ –≤—ã–±–æ—Ä–∫–µ'; tf.appendChild(tfl);
  const A=agg(rows);
  for(const m of metrics){
    const v=A[m.k]; const c=document.createElement('td'); c.className='num';
    c.textContent = (m.k==='pct' || m.k==='pct_full') ? (v==null?'‚Äî':fmtP.format(v)+'%') : (v==null?'‚Äî':fmt.format(v));
    paint(c,m.k,v); tf.appendChild(c);
  }
  DOM.tfoot.appendChild(tf);

  DOM.label.textContent = currentDate();
}

/* ===== –°–≤–µ—Ä–Ω—É—Ç—å/—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å ===== */
function collapseAll(){
  state.collapsed.clear();
  const rows = applyFilter(data);
  const tree = buildTree(rows);
  const walk=n=>{ if(n.children.length) state.collapsed.add(n.path); n.children.forEach(walk); };
  tree.forEach(walk);
}

/* ===== –≠–∫—Å–ø–æ—Ä—Ç baked CSV (UTF-8 BOM) ===== */
function exportCsvRaw(){
  const BOM = '\uFEFF';
  const blob = new Blob([BOM + CSV_TEXT], {type:'text/csv;charset=utf-8'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a'); a.href=url; a.download=`pivot-source-${Date.now()}.csv`;
  document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
}

/* ===== –°–ª—É—à–∞—Ç–µ–ª–∏ ===== */
DOM.slider.oninput = e => { state.dateIndex = +e.target.value; DOM.label.textContent = currentDate(); render(); };
DOM.slider.onchange = null;
DOM.collapse.onclick = ()=>{ collapseAll(); render(); };
DOM.expand.onclick = ()=>{ state.collapsed.clear(); render(); };
DOM.downloadRaw.onclick  = exportCsvRaw;
</script>
</body>
</html>
